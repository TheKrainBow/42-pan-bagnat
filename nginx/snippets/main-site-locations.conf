        location = /healthz {
            access_log off;
            default_type text/plain;
            return 200 'ok';
        }

        # Allow large bodies only for icon upload endpoints
        location ~ ^/api/v1/admin/modules/[^/]+/icon/upload$ {
            client_max_body_size 50m;
            proxy_request_buffering off;
            proxy_pass         http://pan-bagnat-backend;
            proxy_redirect     off;
        }

        location ~ ^/api/v1/admin/modules/[^/]+/pages/[^/]+/icon/upload$ {
            client_max_body_size 50m;
            proxy_request_buffering off;
            proxy_pass         http://pan-bagnat-backend;
            proxy_redirect     off;
        }

        location /api/ {
            proxy_pass         http://pan-bagnat-backend;
            proxy_redirect     off;
        }

        location /auth/ {
            proxy_pass         http://pan-bagnat-backend;
            proxy_redirect     off;
        }

        location /ws {
            proxy_pass         http://pan-bagnat-backend;
            proxy_set_header   Upgrade $http_upgrade;
            proxy_set_header   Connection $connection_upgrade;
            proxy_read_timeout 600s;
        }

        # Serve backend-uploaded icons only; let the frontend own other /assets/*
        location ^~ /assets/module-icons/ {
            proxy_pass         http://pan-bagnat-backend;
            proxy_redirect     off;
        }

        location ^~ /assets/page-icons/ {
            proxy_pass         http://pan-bagnat-backend;
            proxy_redirect     off;
        }

        location / {
            proxy_pass         http://pan-bagnat-frontend;
        }
